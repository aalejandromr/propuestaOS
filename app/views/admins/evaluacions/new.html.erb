<div class="col-xs-12">
      
      <div class="col-xs-12">
        <div class="col-xs-6">
          <!--<form enctype='application/json'>
            <label> Agrega descripcion de la evaluacion </label>
            <input type="text" name='descripcion'>
          </form>-->
          <input id='course_id' type='hidden' value= <%= params[:course_id] %>>
          <form>
            <label> Agrega descripcion de la evaluacion </label>
            <input type="text" name="descripcion">
          </form>

        </div>
        <div class="col-xs-6">
          <button id="add-text" type="submit" class="btn btn-primary">
          Pregunta Abierta
          </button>
        <button id="add-radio-button" type="submit" class="btn btn-primary">
          Seleccion Multiple
        </button>
        <button id="add-checkbox" type="submit" class="btn btn-primary">
          Seleccion Variada
        </button>
        </div>
    </div>

    <div class="col-xs-12 module-container">

    </div>
    <div class='col-xs-12'>
      <button id='agregar' type='submit' class='btn btn-primary btn-block'>
        Agregar
      </button>
    </div>

    


</div>

<script type="text/javascript">
  var num = 1;

$("#add-text").click(function (){
  var text = "<div class='col-xs-12'> <div class='col-xs-12'> <form id='pregunta'> " + "<label> " + num + ". pregunta: </label>" + "<textarea name='pregunta_abierta' rows='3' cols='40' ></textarea> <a id='remove-text'> <ul class='nav nav-pills'> <li> Eliminar </a> </li> </ul> </form> </div> </div>";

  $('.module-container').append(text);
  num = num + 1;

  $('a#remove-text').unbind().click(function(){
    num = num - 1;
    $($($($($(this).parent()).parent()).parent()).parent()).parent().remove();
    //console.log($($($($($(this).parent()).parent()).parent()).parent()).parent());
  });
});

$("#add-radio-button").click(function(){
  var button = $("<button id='radio' class='btn btn-primary'> Agregar posible respuesta </button>");
  var text = $("<div class='agregados'> <div class='col-xs-12'> <div class='col-xs-9'> <form id='pregunta'> <label> " + num + ". Pregunta </label>" + "<input type='text' name='pregunta_rb' id='pregunta_radio'> (Agrega las posibles respuestas y selecciona la correcta) <a id='remove-radio'> <ul class='nav nav-pills'> <li> Eliminar </a> </li> </ul> </form> </div> <div class='col-xs-3'> " + $(button)[0].outerHTML + "</div> <div class='col-xs-12'> <form> </form> </div> </div> </div>");
  $('.module-container').append($(text)[0].innerHTML);
  
  $("button#radio").unbind().click(function(){
    var radio = $("<div class='col-xs-3'> <div class='col-xs-2'><input type='radio' name='selector'> </div> <div class='col-xs-10'> <input type='text' name='radio_respuesta'> </div> </div>");
     $($($($($(this).parent()).siblings()).last()).children()).append(radio);
  });

    $('a#remove-radio').unbind().click(function(){
    num = num - 1;
    $($($($($(this).parent()).parent()).parent()).parent()).parent().remove();
    //console.log($($($($($(this).parent()).parent()).parent()).parent()).parent());
  });
  num = num + 1;
});

$("#add-checkbox").click(function(){
  var button = $("<button id='checkbox' class='btn btn-primary'> Agregar posible respuesta </button>");
  var text = $("<div class='agregados'> <div class='col-xs-12'> <div class='col-xs-9'> <form id='pregunta'> <label> " + num + ". Pregunta </label>" + "<input type='text' name='pregunta_checkbox' id='pregunta_radio'> (Agrega las posibles respuestas y selecciona las correctas) <ul class='nav nav-pills'> <li> <a id='remove-checkbox'> Eliminar </a> </li> </ul> </form>  </div> <div class='col-xs-3'> " + $(button)[0].outerHTML + "</div> <div class='col-xs-12'> <form> </form> </div> </div> </div> </div>");
  
  $('.module-container').append($(text)[0].innerHTML);
  

  $("button#checkbox").unbind().click(function(){
    var checkbox = $("<div class='col-xs-3'> <div class='col-xs-2'> <input type='checkbox' name='seleccionada' value=" + true + "> </div> <div class='col-xs-10'> <input type='text' name='checkbox_respuesta'> </div> </div>");
    $($($($($(this).parent()).siblings()).last()).children()).append(checkbox);
  });


  $('a#remove-checkbox').unbind().click(function(){
    num = num - 1;
    $($($($($(this).parent()).parent()).parent()).parent()).parent().remove()
    //console.log($($($($($(this).parent()).parent()).parent()).parent()).parent());
  });

  num = num + 1;
});


$("button#agregar").click(function(){
    var form = $('form').serializeArray();
    var radios = [];
    var checkboxs = [];
    var textareas = [];
    var correctas_checkboxs = [];
    var correctas_radios = [];
    var fcorrecta = 0;
    var rfcorrecta = 0;
    var descripcion;
    var course_id = $('#course_id').val();

    $(form).each(function(index, value){

        if(value.name == 'descripcion' && value.value != "")
        {
          descripcion = value.value;
        }
        else if(value.name == 'seleccionada' && value.value != "")
        {
          fcorrecta = 1;
        }
        else if (value.name == 'selector' && value.value != ""){
          rfcorrecta = 1;
        }
        else if(value.name == 'pregunta_abierta' && value.value != "")
        {
          textareas.push(value.value);
        }
        else if(value.name == 'pregunta_rb' || value.name == 'radio_respuesta' && value.value != "")
        {
          radios.push(value.value);
          if(rfcorrecta == 1 && value.value != "")
          {
            correctas_radios.push(value.value);
            rfcorrecta = 0;
          }
        }
        else if(value.name == 'pregunta_checkbox' || value.name == 'checkbox_respuesta' && value.value != "")
        {
          checkboxs.push(value.value);
          if(fcorrecta == 1 && value.value != "")
            {
              correctas_checkboxs.push(value.value);
              fcorrecta = 0;
            }
        }
    });

    /*

    $(correctas_radios).each(function (index, radios)
    {
      console.log("Correctas Radio: " + radios);
    });
    $(correctas_checkboxs).each(function (index, correcta)
    {
      console.log("Correctas checkbox: " + correcta);
    });
    $(radios).each(function (index, radio){
      console.log("Radios: " + radio);
    });
    $(checkboxs).each(function (index, checkbox){
      console.log("Checkbox: "  + checkbox);
    });
    $(textareas).each(function (index, texts){
      console.log("TexAreas: " + texts);
    });
    */
    $.ajax({
      url: "/admins/evaluacions/create_evaluacion",
      data: {
        descripcion: descripcion,
        form: form,
        course_id: course_id
      },
    });

  });
</script>